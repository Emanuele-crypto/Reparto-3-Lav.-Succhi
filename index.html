<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema Gestione Produzione Agrumi - Reparto 3</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f8f9fa;
        }
        .header {
            background-color: #3498db;
            color: white;
            padding: 15px 0;
            margin-bottom: 20px;
        }
        .card {
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .card-header {
            background-color: #d6eaf8;
            font-weight: bold;
        }
        .process-card {
            border-left: 4px solid #3498db;
            height: 100%;
            transition: all 0.3s;
        }
        .process-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
        }
        .btn-custom {
            background-color: #3498db;
            color: white;
        }
        .btn-custom:hover {
            background-color: #2980b9;
            color: white;
        }
        .section-header {
            background-color: #d6eaf8;
            padding: 10px 15px;
            margin-bottom: 15px;
            border-radius: 5px;
            font-weight: bold;
            color: #2980b9;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .machine-card {
            border: 1px solid #ddd;
            border-radius: 5px;
            height: 100%;
            transition: all 0.3s;
            overflow: hidden;
        }
        .machine-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
        }
        .machine-header {
            background-color: #d6eaf8;
            padding: 10px;
            text-align: center;
            font-weight: bold;
            color: #2980b9;
        }
        .machine-body {
            padding: 15px;
            position: relative;
        }
        .status-indicator {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            position: absolute;
            top: 10px;
            right: 10px;
        }
        .status-idle {
            background-color: #f39c12;
        }
        .status-active {
            background-color: #2ecc71;
        }
        .status-maintenance {
            background-color: #e74c3c;
        }
        .progress {
            height: 8px;
            margin: 10px 0;
        }
        .progress-bar {
            background-color: #3498db;
        }
        .nav-pills .nav-link.active {
            background-color: #3498db;
        }
        .nav-pills .nav-link {
            color: #3498db;
        }
        .required-field::after {
            content: " *";
            color: red;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <h1><i class="bi bi-droplet-half"></i> Reparto 3 - Lavorazione Succhi</h1>
                </div>
                <div class="col-md-4 text-end">
                    <button class="btn btn-light me-2" id="btn-reparto-1">
                        <i class="bi bi-arrow-left-circle"></i> Reparto 1 - Ricezione e Scarico Frutta
                    </button>
                    <button class="btn btn-light" id="btn-reparto-2">
                        <i class="bi bi-arrow-left-circle"></i> Reparto 2 - Trasformazione
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- Navigazione tra sezioni -->
        <ul class="nav nav-pills mb-4">
            <li class="nav-item">
                <a class="nav-link active" href="#concentratori">Concentratori</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#distillatori">Distillatori</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#pastorizzatori">Pastorizzatori</a>
            </li>
        </ul>

        <!-- Sezione Concentratori -->
        <div id="concentratori" class="mb-5">
            <div class="section-header">
                <span><i class="bi bi-funnel"></i> Concentratori</span>
                <button class="btn btn-sm btn-custom" data-bs-toggle="modal" data-bs-target="#concentratoreModal">
                    <i class="bi bi-plus-circle"></i> Nuovo Processo
                </button>
            </div>

            <div class="row">
                <!-- APV1 -->
                <div class="col-md-6 mb-4">
                    <div class="card machine-card">
                        <div class="machine-header">APV1</div>
                        <div class="machine-body">
                            <div class="status-indicator status-idle"></div>
                            <div class="row">
                                <div class="col-md-7">
                                    <p><strong>Stato:</strong> <span class="badge bg-warning">In attesa</span></p>
                                    <p><strong>Prodotto:</strong> -</p>
                                    <p><strong>Tipo Agrume:</strong> -</p>
                                    <p><strong>Certificazione:</strong> -</p>
                                    <p><strong>Tenore di Polpa:</strong> -</p>
                                </div>
                                <div class="col-md-5">
                                    <p><strong>Linea:</strong> -</p>
                                    <p><strong>Brix iniziale:</strong> -</p>
                                    <p><strong>Brix target:</strong> -</p>
                                    <p><strong>Tempo stimato:</strong> -</p>
                                </div>
                            </div>
                            <div class="mt-2">
                                <small>Progresso:</small>
                                <div class="progress">
                                    <div class="progress-bar" role="progressbar" style="width: 0%" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                                <small class="d-flex justify-content-between">
                                    <span>0%</span>
                                    <span>Tempo rimanente: 0 min</span>
                                </small>
                            </div>
                            <div class="d-flex justify-content-between mt-3">
                                <button class="btn btn-sm btn-outline-secondary" onclick="viewMachineDetails('APV1', 'concentratore')">
                                    <i class="bi bi-info-circle"></i> Dettagli
                                </button>
                                <button class="btn btn-sm btn-custom" onclick="startProcess('APV1', 'concentratore')">
                                    <i class="bi bi-play-fill"></i> Avvia
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- APV2 -->
                <div class="col-md-6 mb-4">
                    <div class="card machine-card">
                        <div class="machine-header">APV2</div>
                        <div class="machine-body">
                            <div class="status-indicator status-idle"></div>
                            <div class="row">
                                <div class="col-md-7">
                                    <p><strong>Stato:</strong> <span class="badge bg-warning">In attesa</span></p>
                                    <p><strong>Prodotto:</strong> -</p>
                                    <p><strong>Tipo Agrume:</strong> -</p>
                                    <p><strong>Certificazione:</strong> -</p>
                                    <p><strong>Tenore di Polpa:</strong> -</p>
                                </div>
                                <div class="col-md-5">
                                    <p><strong>Linea:</strong> -</p>
                                    <p><strong>Brix iniziale:</strong> -</p>
                                    <p><strong>Brix target:</strong> -</p>
                                    <p><strong>Tempo stimato:</strong> -</p>
                                </div>
                            </div>
                            <div class="mt-2">
                                <small>Progresso:</small>
                                <div class="progress">
                                    <div class="progress-bar" role="progressbar" style="width: 0%" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                                <small class="d-flex justify-content-between">
                                    <span>0%</span>
                                    <span>Tempo rimanente: 0 min</span>
                                </small>
                            </div>
                            <div class="d-flex justify-content-between mt-3">
                                <button class="btn btn-sm btn-outline-secondary" onclick="viewMachineDetails('APV2', 'concentratore')">
                                    <i class="bi bi-info-circle"></i> Dettagli
                                </button>
                                <button class="btn btn-sm btn-custom" onclick="startProcess('APV2', 'concentratore')">
                                    <i class="bi bi-play-fill"></i> Avvia
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Sezione Distillatori -->
        <div id="distillatori" class="mb-5">
            <div class="section-header">
                <span><i class="bi bi-thermometer-half"></i> Distillatori</span>
                <button class="btn btn-sm btn-custom" data-bs-toggle="modal" data-bs-target="#distillatoreModal">
                    <i class="bi bi-plus-circle"></i> Nuovo Processo
                </button>
            </div>

            <div class="row">
                <!-- Santoro -->
                <div class="col-md-4 mb-4">
                    <div class="card machine-card">
                        <div class="machine-header">Santoro</div>
                        <div class="machine-body">
                            <div class="status-indicator status-idle"></div>
                            <p><strong>Stato:</strong> <span class="badge bg-warning">In attesa</span></p>
                            <p><strong>Prodotto:</strong> -</p>
                            <p><strong>Tipo Agrume:</strong> -</p>
                            <p><strong>Certificazione:</strong> -</p>
                            <p><strong>Linea:</strong> -</p>
                            <div class="mt-2">
                                <small>Progresso:</small>
                                <div class="progress">
                                    <div class="progress-bar" role="progressbar" style="width: 0%" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                                <small class="d-flex justify-content-between">
                                    <span>0%</span>
                                    <span>Tempo: 0 min</span>
                                </small>
                            </div>
                            <div class="d-flex justify-content-between mt-3">
                                <button class="btn btn-sm btn-outline-secondary" onclick="viewMachineDetails('Santoro', 'distillatore')">
                                    <i class="bi bi-info-circle"></i> Dettagli
                                </button>
                                <button class="btn btn-sm btn-custom" onclick="startProcess('Santoro', 'distillatore')">
                                    <i class="bi bi-play-fill"></i> Avvia
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Padovan -->
                <div class="col-md-4 mb-4">
                    <div class="card machine-card">
                        <div class="machine-header">Padovan</div>
                        <div class="machine-body">
                            <div class="status-indicator status-idle"></div>
                            <p><strong>Stato:</strong> <span class="badge bg-warning">In attesa</span></p>
                            <p><strong>Prodotto:</strong> -</p>
                            <p><strong>Tipo Agrume:</strong> -</p>
                            <p><strong>Certificazione:</strong> -</p>
                            <p><strong>Linea:</strong> -</p>
                            <div class="mt-2">
                                <small>Progresso:</small>
                                <div class="progress">
                                    <div class="progress-bar" role="progressbar" style="width: 0%" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                                <small class="d-flex justify-content-between">
                                    <span>0%</span>
                                    <span>Tempo: 0 min</span>
                                </small>
                            </div>
                            <div class="d-flex justify-content-between mt-3">
                                <button class="btn btn-sm btn-outline-secondary" onclick="viewMachineDetails('Padovan', 'distillatore')">
                                    <i class="bi bi-info-circle"></i> Dettagli
                                </button>
                                <button class="btn btn-sm btn-custom" onclick="startProcess('Padovan', 'distillatore')">
                                    <i class="bi bi-play-fill"></i> Avvia
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Pilato 1 -->
                <div class="col-md-4 mb-4">
                    <div class="card machine-card">
                        <div class="machine-header">Pilato 1</div>
                        <div class="machine-body">
                            <div class="status-indicator status-idle"></div>
                            <p><strong>Stato:</strong> <span class="badge bg-warning">In attesa</span></p>
                            <p><strong>Prodotto:</strong> -</p>
                            <p><strong>Tipo Agrume:</strong> -</p>
                            <p><strong>Certificazione:</strong> -</p>
                            <p><strong>Linea:</strong> -</p>
                            <div class="mt-2">
                                <small>Progresso:</small>
                                <div class="progress">
                                    <div class="progress-bar" role="progressbar" style="width: 0%" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                                <small class="d-flex justify-content-between">
                                    <span>0%</span>
                                    <span>Tempo: 0 min</span>
                                </small>
                            </div>
                            <div class="d-flex justify-content-between mt-3">
                                <button class="btn btn-sm btn-outline-secondary" onclick="viewMachineDetails('Pilato1', 'distillatore')">
                                    <i class="bi bi-info-circle"></i> Dettagli
                                </button>
                                <button class="btn btn-sm btn-custom" onclick="startProcess('Pilato1', 'distillatore')">
                                    <i class="bi bi-play-fill"></i> Avvia
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Pilato 2 -->
                <div class="col-md-6 mb-4">
                    <div class="card machine-card">
                        <div class="machine-header">Pilato 2</div>
                        <div class="machine-body">
                            <div class="status-indicator status-idle"></div>
                            <div class="row">
                                <div class="col-md-7">
                                    <p><strong>Stato:</strong> <span class="badge bg-warning">In attesa</span></p>
                                    <p><strong>Prodotto:</strong> -</p>
                                    <p><strong>Tipo Agrume:</strong> -</p>
                                    <p><strong>Certificazione:</strong> -</p>
                                </div>
                                <div class="col-md-5">
                                    <p><strong>Linea:</strong> -</p>
                                    <p><strong>Tenore di Polpa:</strong> -</p>
                                    <p><strong>Tempo stimato:</strong> -</p>
                                </div>
                            </div>
                            <div class="mt-2">
                                <small>Progresso:</small>
                                <div class="progress">
                                    <div class="progress-bar" role="progressbar" style="width: 0%" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                                <small class="d-flex justify-content-between">
                                    <span>0%</span>
                                    <span>Tempo rimanente: 0 min</span>
                                </small>
                            </div>
                            <div class="d-flex justify-content-between mt-3">
                                <button class="btn btn-sm btn-outline-secondary" onclick="viewMachineDetails('Pilato2', 'distillatore')">
                                    <i class="bi bi-info-circle"></i> Dettagli
                                </button>
                                <button class="btn btn-sm btn-custom" onclick="startProcess('Pilato2', 'distillatore')">
                                    <i class="bi bi-play-fill"></i> Avvia
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Joe -->
                <div class="col-md-6 mb-4">
                    <div class="card machine-card">
                        <div class="machine-header">Joe</div>
                        <div class="machine-body">
                            <div class="status-indicator status-idle"></div>
                            <div class="row">
                                <div class="col-md-7">
                                    <p><strong>Stato:</strong> <span class="badge bg-warning">In attesa</span></p>
                                    <p><strong>Prodotto:</strong> -</p>
                                    <p><strong>Tipo Agrume:</strong> -</p>
                                    <p><strong>Certificazione:</strong> -</p>
                                </div>
                                <div class="col-md-5">
                                    <p><strong>Linea:</strong> -</p>
                                    <p><strong>Tenore di Polpa:</strong> -</p>
                                    <p><strong>Tempo stimato:</strong> -</p>
                                </div>
                            </div>
                            <div class="mt-2">
                                <small>Progresso:</small>
                                <div class="progress">
                                    <div class="progress-bar" role="progressbar" style="width: 0%" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                                <small class="d-flex justify-content-between">
                                    <span>0%</span>
                                    <span>Tempo rimanente: 0 min</span>
                                </small>
                            </div>
                            <div class="d-flex justify-content-between mt-3">
                                <button class="btn btn-sm btn-outline-secondary" onclick="viewMachineDetails('Joe', 'distillatore')">
                                    <i class="bi bi-info-circle"></i> Dettagli
                                </button>
                                <button class="btn btn-sm btn-custom" onclick="startProcess('Joe', 'distillatore')">
                                    <i class="bi bi-play-fill"></i> Avvia
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Sezione Pastorizzatori -->
        <div id="pastorizzatori" class="mb-5">
            <div class="section-header">
                <span><i class="bi bi-fire"></i> Pastorizzatori</span>
                <button class="btn btn-sm btn-custom" data-bs-toggle="modal" data-bs-target="#pastorizzatoreModal">
                    <i class="bi bi-plus-circle"></i> Nuovo Processo
                </button>
            </div>

            <div class="row">
                <!-- Pastorizzatore Arancia -->
                <div class="col-md-6 mb-4">
                    <div class="card machine-card">
                        <div class="machine-header">Pastorizzatore Arancia</div>
                        <div class="machine-body">
                            <div class="status-indicator status-idle"></div>
                            <div class="row">
                                <div class="col-md-7">
                                    <p><strong>Stato:</strong> <span class="badge bg-warning">In attesa</span></p>
                                    <p><strong>Prodotto:</strong> -</p>
                                    <p><strong>Tipo Agrume:</strong> -</p>
                                    <p><strong>Certificazione:</strong> -</p>
                                    <p><strong>Tenore di Polpa:</strong> -</p>
                                </div>
                                <div class="col-md-5">
                                    <p><strong>Linea:</strong> -</p>
                                    <p><strong>Temperatura:</strong> -</p>
                                    <p><strong>Portata:</strong> -</p>
                                    <p><strong>Tempo stimato:</strong> -</p>
                                </div>
                            </div>
                            <div class="mt-2">
                                <small>Progresso:</small>
                                <div class="progress">
                                    <div class="progress-bar" role="progressbar" style="width: 0%" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                                <small class="d-flex justify-content-between">
                                    <span>0%</span>
                                    <span>Tempo rimanente: 0 min</span>
                                </small>
                            </div>
                            <div class="d-flex justify-content-between mt-3">
                                <button class="btn btn-sm btn-outline-secondary" onclick="viewMachineDetails('PastArancia', 'pastorizzatore')">
                                    <i class="bi bi-info-circle"></i> Dettagli
                                </button>
                                <button class="btn btn-sm btn-custom" onclick="startProcess('PastArancia', 'pastorizzatore')">
                                    <i class="bi bi-play-fill"></i> Avvia
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Pastorizzatore Profea -->
                <div class="col-md-6 mb-4">
                    <div class="card machine-card">
                        <div class="machine-header">Pastorizzatore Profea</div>
                        <div class="machine-body">
                            <div class="status-indicator status-idle"></div>
                            <div class="row">
                                <div class="col-md-7">
                                    <p><strong>Stato:</strong> <span class="badge bg-warning">In attesa</span></p>
                                    <p><strong>Prodotto:</strong> -</p>
                                    <p><strong>Tipo Agrume:</strong> -</p>
                                    <p><strong>Certificazione:</strong> -</p>
                                    <p><strong>Tenore di Polpa:</strong> -</p>
                                </div>
                                <div class="col-md-5">
                                    <p><strong>Linea:</strong> -</p>
                                    <p><strong>Temperatura:</strong> -</p>
                                    <p><strong>Portata:</strong> -</p>
                                    <p><strong>Tempo stimato:</strong> -</p>
                                </div>
                            </div>
                            <div class="mt-2">
                                <small>Progresso:</small>
                                <div class="progress">
                                    <div class="progress-bar" role="progressbar" style="width: 0%" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                                <small class="d-flex justify-content-between">
                                    <span>0%</span>
                                    <span>Tempo rimanente: 0 min</span>
                                </small>
                            </div>
                            <div class="d-flex justify-content-between mt-3">
                                <button class="btn btn-sm btn-outline-secondary" onclick="viewMachineDetails('PastProfea', 'pastorizzatore')">
                                    <i class="bi bi-info-circle"></i> Dettagli
                                </button>
                                <button class="btn btn-sm btn-custom" onclick="startProcess('PastProfea', 'pastorizzatore')">
                                    <i class="bi bi-play-fill"></i> Avvia
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Concentratore -->
    <div class="modal fade" id="concentratoreModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-light">
                    <h5 class="modal-title"><i class="bi bi-funnel"></i> Nuovo Processo Concentratore</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="concentratore-form">
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="conc-macchina" class="form-label required-field">Seleziona Concentratore</label>
                                <select class="form-select" id="conc-macchina" required>
                                    <option value="" selected disabled>Seleziona...</option>
                                    <option value="APV1">APV1</option>
                                    <option value="APV2">APV2</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label for="conc-prodotto" class="form-label required-field">Prodotto da Concentrare</label>
                                <select class="form-select" id="conc-prodotto" required>
                                    <option value="" selected disabled>Seleziona...</option>
                                    <option value="Succo">Succo</option>
                                    <option value="Torchiato">Torchiato</option>
                                    <option value="Estratto">Estratto</option>
                                </select>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="conc-agrume" class="form-label required-field">Tipo di Agrume</label>
                                <select class="form-select" id="conc-agrume" required>
                                    <option value="" selected disabled>Seleziona...</option>
                                    <option value="Arance">Arance</option>
                                    <option value="Arance Rosse">Arance Rosse</option>
                                    <option value="Limoni">Limoni</option>
                                    <option value="Mandarini">Mandarini</option>
                                    <option value="Pompelmi">Pompelmi</option>
                                    <option value="Altro">Altro</option>
                                </select>
                                <div id="conc-altro-agrume-container" style="display: none;" class="mt-2">
                                    <input type="text" class="form-control" id="conc-altro-agrume" placeholder="Specifica altro agrume">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <label for="conc-certificazione" class="form-label required-field">Certificazione</label>
                                <select class="form-select" id="conc-certificazione" required>
                                    <option value="" selected disabled>Seleziona...</option>
                                    <option value="BIO EU">BIO EU</option>
                                    <option value="BIO DEMETER">BIO DEMETER</option>
                                    <option value="CONVENZIONALE">CONVENZIONALE</option>
                                    <option value="IGP">IGP</option>
                                    <option value="ALTRO">ALTRO</option>
                                </select>
                                <div id="conc-altra-certificazione-container" style="display: none;" class="mt-2">
                                    <input type="text" class="form-control" id="conc-altra-certificazione" placeholder="Specifica altra certificazione">
                                </div>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="conc-linea" class="form-label required-field">Linea di<label for="conc-linea" class="form-label required-field">Linea di Trasformazione</label>
                                <select class="form-select" id="conc-linea" required>
                                    <option value="" selected disabled>Seleziona...</option>
                                    <option value="BOE">BOE</option>
                                    <option value="GOE INT">GOE INT</option>
                                    <option value="B/SF">B/SF</option>
                                    <option value="ALTRA">ALTRA</option>
                                </select>
                                <div id="conc-altra-linea-container" style="display: none;" class="mt-2">
                                    <input type="text" class="form-control" id="conc-altra-linea" placeholder="Specifica altra linea">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <label for="conc-polpa" class="form-label required-field">Tenore di Polpa</label>
                                <select class="form-select" id="conc-polpa" required>
                                    <option value="" selected disabled>Seleziona...</option>
                                    <option value="Limpido">Limpido</option>
                                    <option value="Semiclear">Semiclear</option>
                                    <option value=">1%">>1%</option>
                                    <option value="Standard">Standard</option>
                                    <option value="Altro">Altro</option>
                                </select>
                                <div id="conc-altra-polpa-container" style="display: none;" class="mt-2">
                                    <input type="text" class="form-control" id="conc-altra-polpa" placeholder="Specifica altro tenore di polpa">
                                </div>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-4">
                                <label for="conc-quantita" class="form-label required-field">Quantità (L)</label>
                                <input type="number" class="form-control" id="conc-quantita" required min="1">
                            </div>
                            <div class="col-md-4">
                                <label for="conc-brix-iniziale" class="form-label required-field">Brix Iniziale (°)</label>
                                <input type="number" class="form-control" id="conc-brix-iniziale" required min="1" max="70" step="0.1">
                            </div>
                            <div class="col-md-4">
                                <label for="conc-brix-finale" class="form-label required-field">Brix Target (°)</label>
                                <input type="number" class="form-control" id="conc-brix-finale" required min="1" max="70" step="0.1">
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="conc-note" class="form-label">Note</label>
                            <textarea class="form-control" id="conc-note" rows="3"></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annulla</button>
                    <button type="button" class="btn btn-custom" id="btn-save-concentratore">Avvia Processo</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Distillatore -->
    <div class="modal fade" id="distillatoreModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-light">
                    <h5 class="modal-title"><i class="bi bi-thermometer-half"></i> Nuovo Processo Distillatore</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="distillatore-form">
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="dist-macchina" class="form-label required-field">Seleziona Distillatore</label>
                                <select class="form-select" id="dist-macchina" required>
                                    <option value="" selected disabled>Seleziona...</option>
                                    <option value="Santoro">Santoro</option>
                                    <option value="Padovan">Padovan</option>
                                    <option value="Pilato1">Pilato 1</option>
                                    <option value="Pilato2">Pilato 2</option>
                                    <option value="Joe">Joe</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label for="dist-prodotto" class="form-label required-field">Prodotto da Distillare</label>
                                <select class="form-select" id="dist-prodotto" required>
                                    <option value="" selected disabled>Seleziona...</option>
                                    <option value="Succo">Succo</option>
                                    <option value="Torchiato">Torchiato</option>
                                    <option value="Estratto">Estratto</option>
                                </select>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="dist-agrume" class="form-label required-field">Tipo di Agrume</label>
                                <select class="form-select" id="dist-agrume" required>
                                    <option value="" selected disabled>Seleziona...</option>
                                    <option value="Arance">Arance</option>
                                    <option value="Arance Rosse">Arance Rosse</option>
                                    <option value="Limoni">Limoni</option>
                                    <option value="Mandarini">Mandarini</option>
                                    <option value="Pompelmi">Pompelmi</option>
                                    <option value="Altro">Altro</option>
                                </select>
                                <div id="dist-altro-agrume-container" style="display: none;" class="mt-2">
                                    <input type="text" class="form-control" id="dist-altro-agrume" placeholder="Specifica altro agrume">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <label for="dist-certificazione" class="form-label required-field">Certificazione</label>
                                <select class="form-select" id="dist-certificazione" required>
                                    <option value="" selected disabled>Seleziona...</option>
                                    <option value="BIO EU">BIO EU</option>
                                    <option value="BIO DEMETER">BIO DEMETER</option>
                                    <option value="CONVENZIONALE">CONVENZIONALE</option>
                                    <option value="IGP">IGP</option>
                                    <option value="ALTRO">ALTRO</option>
                                </select>
                                <div id="dist-altra-certificazione-container" style="display: none;" class="mt-2">
                                    <input type="text" class="form-control" id="dist-altra-certificazione" placeholder="Specifica altra certificazione">
                                </div>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="dist-linea" class="form-label required-field">Linea di Trasformazione</label>
                                <select class="form-select" id="dist-linea" required>
                                    <option value="" selected disabled>Seleziona...</option>
                                    <option value="BOE">BOE</option>
                                    <option value="GOE INT">GOE INT</option>
                                    <option value="B/SF">B/SF</option>
                                    <option value="ALTRA">ALTRA</option>
                                </select>
                                <div id="dist-altra-linea-container" style="display: none;" class="mt-2">
                                    <input type="text" class="form-control" id="dist-altra-linea" placeholder="Specifica altra linea">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <label for="dist-polpa" class="form-label required-field">Tenore di Polpa</label>
                                <select class="form-select" id="dist-polpa" required>
                                    <option value="" selected disabled>Seleziona...</option>
                                    <option value="Limpido">Limpido</option>
                                    <option value="Semiclear">Semiclear</option>
                                    <option value=">1%">>1%</option>
                                    <option value="Standard">Standard</option>
                                    <option value="Altro">Altro</option>
                                </select>
                                <div id="dist-altra-polpa-container" style="display: none;" class="mt-2">
                                    <input type="text" class="form-control" id="dist-altra-polpa" placeholder="Specifica altro tenore di polpa">
                                </div>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="dist-quantita" class="form-label required-field">Quantità (L)</label>
                                <input type="number" class="form-control" id="dist-quantita" required min="1">
                            </div>
                            <div class="col-md-6">
                                <label for="dist-temperatura" class="form-label required-field">Temperatura (°C)</label>
                                <input type="number" class="form-control" id="dist-temperatura" required min="1" max="200">
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="dist-note" class="form-label">Note</label>
                            <textarea class="form-control" id="dist-note" rows="3"></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annulla</button>
                    <button type="button" class="btn btn-custom" id="btn-save-distillatore">Avvia Processo</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Pastorizzatore -->
    <div class="modal fade" id="pastorizzatoreModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-light">
                    <h5 class="modal-title"><i class="bi bi-fire"></i> Nuovo Processo Pastorizzatore</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="pastorizzatore-form">
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="past-macchina" class="form-label required-field">Seleziona Pastorizzatore</label>
                                <select class="form-select" id="past-macchina" required>
                                    <option value="" selected disabled>Seleziona...</option>
                                    <option value="PastArancia">Pastorizzatore Arancia</option>
                                    <option value="PastProfea">Pastorizzatore Profea</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label for="past-prodotto" class="form-label required-field">Prodotto da Pastorizzare</label>
                                <select class="form-select" id="past-prodotto" required>
                                    <option value="" selected disabled>Seleziona...</option>
                                    <option value="Succo">Succo</option>
                                    <option value="Torchiato">Torchiato</option>
                                    <option value="Estratto">Estratto</option>
                                </select>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="past-agrume" class="form-label required-field">Tipo di Agrume</label>
                                <select class="form-select" id="past-agrume" required>
                                    <option value="" selected disabled>Seleziona...</option>
                                    <option value="Arance">Arance</option>
                                    <option value="Arance Rosse">Arance Rosse</option>
                                    <option value="Limoni">Limoni</option>
                                    <option value="Mandarini">Mandarini</option>
                                    <option value="Pompelmi">Pompelmi</option>
                                    <option value="Altro">Altro</option>
                                </select>
                                <div id="past-altro-agrume-container" style="display: none;" class="mt-2">
                                    <input type="text" class="form-control" id="past-altro-agrume" placeholder="Specifica altro agrume">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <label for="past-certificazione" class="form-label required-field">Certificazione</label>
                                <select class="form-select" id="past-certificazione" required>
                                    <option value="" selected disabled>Seleziona...</option>
                                    <option value="BIO EU">BIO EU</option>
                                    <option value="BIO DEMETER">BIO DEMETER</option>
                                    <option value="CONVENZIONALE">CONVENZIONALE</option>
                                    <option value="IGP">IGP</option>
                                    <option value="ALTRO">ALTRO</option>
                                </select>
                                <div id="past-altra-certificazione-container" style="display: none;" class="mt-2">
                                    <input type="text" class="form-control" id="past-altra-certificazione" placeholder="Specifica altra certificazione">
                                </div>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="past-linea" class="form-label required-field">Linea di Trasformazione</label>
                                <select class="form-select" id="past-linea" required>
                                    <option value="" selected disabled>Seleziona...</option>
                                    <option value="BOE">BOE</option>
                                    <option value="GOE INT">GOE INT</option>
                                    <option value="B/SF">B/SF</option>
                                    <option value="ALTRA">ALTRA</option>
                                </select>
                                <div id="past-altra-linea-container" style="display: none;" class="mt-2">
                                    <input type="text" class="form-control" id="past-altra-linea" placeholder="Specifica altra linea">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <label for="past-polpa" class="form-label required-field">Tenore di Polpa</label>
                                <select class="form-select" id="past-polpa" required>
                                    <option value="" selected disabled>Seleziona...</option>
                                    <option value="Limpido">Limpido</option>
                                    <option value="Semiclear">Semiclear</option>
                                    <option value=">1%">>1%</option>
                                    <option value="Standard">Standard</option>
                                    <option value="Altro">Altro</option>
                                </select>
                                <div id="past-altra-polpa-container" style="display: none;" class="mt-2">
                                    <input type="text" class="form-control" id="past-altra-polpa" placeholder="Specifica altro tenore di polpa">
                                </div>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-4">
                                <label for="past-quantita" class="form-label required-field">Quantità (L)</label>
                                <input type="number" class="form-control" id="past-quantita" required min="1">
                            </div>
                            <div class="col-md-4">
                                <label for="past-temperatura" class="form-label required-field">Temperatura (°C)</label>
                                <input type="number" class="form-control" id="past-temperatura" required min="1" max="150" step="0.1">
                            </div>
                            <div class="col-md-4">
                                <label for="past-portata" class="form-label required-field">Portata (L/h)</label>
                                <input type="number" class="form-control" id="past-portata" required min="1">
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="past-note" class="form-label">Note</label>
                            <textarea class="form-control" id="past-note" rows="3"></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annulla</button>
                    <button type="button" class="btn btn-custom" id="btn-save-pastorizzatore">Avvia Processo</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Script JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
    <script>
        $(document).ready(function() {
            // Navigazione tabs
            $(".nav-link").click(function(e) {
                e.preventDefault();
                const target = $(this).attr("href");
                $("html, body").animate({
                    scrollTop: $(target).offset().top - 80
                }, 500);
            });

            // Gestione dei campi "Altro" nei form
            $("#conc-agrume").change(function() {
                if ($(this).val() === "Altro") {
                    $("#conc-altro-agrume-container").show();
                } else {
                    $("#conc-altro-agrume-container").hide();
                }
            });

            $("#conc-certificazione").change(function() {
                if ($(this).val() === "ALTRO") {
                    $("#conc-altra-certificazione-container").show();
                } else {
                    $("#conc-altra-certificazione-container").hide();
                }
            });

            $("#conc-linea").change(function() {
                if ($(this).val() === "ALTRA") {
                    $("#conc-altra-linea-container").show();
                } else {
                    $("#conc-altra-linea-container").hide();
                }
            });

            $("#conc-polpa").change(function() {
                if ($(this).val() === "Altro") {
                    $("#conc-altra-polpa-container").show();
                } else {
                    $("#conc-altra-polpa-container").hide();
                }
            });

            // Stessa logica per gli altri form
            $("#dist-agrume, #past-agrume").change(function() {
                const prefix = $(this).attr("id").split("-")[0];
                if ($(this).val() === "Altro") {
                    $(`#${prefix}-altro-agrume-container`).show();
                } else {
                    $(`#${prefix}-altro-agrume-container`).hide();
                }
            });

            $("#dist-certificazione, #past-certificazione").change(function() {
                const prefix = $(this).attr("id").split("-")[0];
                if ($(this).val() === "ALTRO") {
                    $(`#${prefix}-altra-certificazione-container`).show();
                } else {
                    $(`#${prefix}-altra-certificazione-container`).hide();
                }
            });

            $("#dist-linea, #past-linea").change(function() {
                const prefix = $(this).attr("id").split("-")[0];
                if ($(this).val() === "ALTRA") {
                    $(`#${prefix}-altra-linea-container`).show();
                } else {
                    $(`#${prefix}-altra-linea-container`).hide();
                }
            });

            $("#dist-polpa, #past-polpa").change(function() {
                const prefix = $(this).attr("id").split("-")[0];
                if ($(this).val() === "Altro") {
                    $(`#${prefix}-altra-polpa-container`).show();
                } else {
                    $(`#${prefix}-altra-polpa-container`).hide();
                }
            });

            // Bottoni collegamento ad altri reparti
            $("#btn-reparto-1").click(function() {
                alert("Collegamento al Reparto 1 - Ricezione e Scarico Frutta");
            });

            $("#btn-reparto-2").click(function() {
                alert("Collegamento al Reparto 2 - Trasformazione");
            });

            // Salvataggio dati form
            $("#btn-save-concentratore").click(function() {
                if (validateForm("concentratore")) {
                    const machine = $("#conc-macchina").val();
                    const product = $("#conc-prodotto").val();
                    const agrume = $("#conc-agrume").val() === "Altro" ? $("#conc-altro-agrume").val() : $("#conc-agrume").val();
                    const certificazione = $("#conc-certificazione").val() === "ALTRO" ? $("#conc-altra-certificazione").val() : $("#conc-certificazione").val();
                    const linea = $("#conc-linea").val() === "ALTRA" ? $("#conc-altra-linea").val() : $("#conc-linea").val();
                    const polpa = $("#conc-polpa").val() === "Altro" ? $("#conc-altra-polpa").val() : $("#conc-polpa").val();
                    
                    updateMachineStatus(machine, "concentratore", {
                        product,
                        agrume,
                        certificazione,
                        linea,
                        polpa,
                        quantita: $("#conc-quantita").val(),
                        brix_iniziale: $("#conc-brix-iniziale").val(),
                        brix_finale: $("#conc-brix-finale").val()
                    });
                    
                    // Chiude il modal
                    $("#concentratoreModal").modal("hide");
                }
            });

            $("#btn-save-distillatore").click(function() {
                if (validateForm("distillatore")) {
                    const machine = $("#dist-macchina").val();
                    const product = $("#dist-prodotto").val();
                    const agrume = $("#dist-agrume").val() === "Altro" ? $("#dist-altro-agrume").val() : $("#dist-agrume").val();
                    const certificazione = $("#dist-certificazione").val() === "ALTRO" ? $("#dist-altra-certificazione").val() : $("#dist-certificazione").val();
                    const linea = $("#dist-linea").val() === "ALTRA" ? $("#dist-altra-linea").val() : $("#dist-linea").val();
                    const polpa = $("#dist-polpa").val() === "Altro" ? $("#dist-altra-polpa").val() : $("#dist-polpa").val();
                    
                    updateMachineStatus(machine, "distillatore", {
                        product,
                        agrume,
                        certificazione,
                        linea,
                        polpa,
                        quantita: $("#dist-quantita").val(),
                        temperatura: $("#dist-temperatura").val()
                    });
                    
                    // Chiude il modal
                    $("#distillatoreModal").modal("hide");
                }
            });

            $("#btn-save-pastorizzatore").click(function() {
                if (validateForm("pastorizzatore")) {
                    const machine = $("#past-macchina").val();
                    const product = $("#past-prodotto").val();
                    const agrume = $("#past-agrume").val() === "Altro" ? $("#past-altro-agrume").val() : $("#past-agrume").val();
                    const certificazione = $("#past-certificazione").val() === "ALTRO" ? $("#past-altra-certificazione").val() : $("#past-certificazione").val();
                    const linea = $("#past-linea").val() === "ALTRA" ? $("#past-altra-linea").val() : $("#past-linea").val();
                    const polpa = $("#past-polpa").val() === "Altro" ? $("#past-altra-polpa").val() : $("#past-polpa").val();
                    
                    updateMachineStatus(machine, "pastorizzatore", {
                        product,
                        agrume,
                        certificazione,
                        linea,
                        polpa,
                        quantita: $("#past-quantita").val(),
                        temperatura: $("#past-temperatura").val(),
                        portata: $("#past-portata").val()
                    });
                    
                    // Chiude il modal
                    $("#pastorizzatoreModal").modal("hide");
                }
            });
        });

        // Funzione per validare i form
        function validateForm(prefix) {
            const form = document.getElementById(`${prefix}-form`);
            if (!form.checkValidity()) {
                // Trigger HTML5 validation
                form.reportValidity();
                return false;
            }

            // Controlla i campi "altro" se necessario
            if ($(`#${prefix}-agrume`).val() === "Altro" && !$(`#${prefix}-altro-agrume`).val()) {
                alert("Specificare l'altro tipo di agrume");
                return false;
            }
            
            if ($(`#${prefix}-certificazione`).val() === "ALTRO" && !$(`#${prefix}-altra-certificazione`).val()) {
                alert("Specificare l'altra certificazione");
                return false;
            }
            
            if ($(`#${prefix}-linea`).val() === "ALTRA" && !$(`#${prefix}-altra-linea`).val()) {
                alert("Specificare l'altra linea di trasformazione");
                return false;
            }
            
            if ($(`#${prefix}-polpa`).val() === "Altro" && !$(`#${prefix}-altra-polpa`).val()) {
                alert("Specificare l'altro tenore di polpa");
                return false;
            }
            
            return true;
        }

        // Funzione per aggiornare lo stato della macchina
        function updateMachineStatus(machine, type, data) {
            // Trova il card della macchina
            const machineCard = $(`.machine-card:has(.machine-header:contains('${machine.replace(/\d+$/, ' $&')}'))`);
            
            // Aggiorna lo stato
            machineCard.find(".status-indicator").removeClass("status-idle").addClass("status-active");
            machineCard.find(".badge").removeClass("bg-warning").addClass("bg-success").text("In lavorazione");
            
            // Aggiorna i dati
            machineCard.find("strong:contains('Prodotto:')").parent().text(`Prodotto: ${data.product}`);
            machineCard.find("strong:contains('Tipo Agrume:')").parent().text(`Tipo Agrume: ${data.agrume}`);
            machineCard.find("strong:contains('Certificazione:')").parent().text(`Certificazione: ${data.certificazione}`);
            
            if (machineCard.find("strong:contains('Tenore di Polpa:')").length) {
                machineCard.find("strong:contains('Tenore di Polpa:')").parent().text(`Tenore di Polpa: ${data.polpa}`);
            }
            
            machineCard.find("strong:contains('Linea:')").parent().text(`Linea: ${data.linea}`);
            
            // Dati specifici per tipo di macchina
            if (type === "concentratore") {
                machineCard.find("strong:contains('Brix iniziale:')").parent().text(`Brix iniziale: ${data.brix_iniziale}°`);
                machineCard.find("strong:contains('Brix target:')").parent().text(`Brix target: ${data.brix_finale}°`);
                machineCard.find("strong:contains('Tempo stimato:')").parent().text(`Tempo stimato: 120 min`);
            } else if (type === "pastorizzatore") {
                machineCard.find("strong:contains('Temperatura:')").parent().text(`Temperatura: ${data.temperatura}°C`);
                machineCard.find("strong:contains('Portata:')").parent().text(`Portata: ${data.portata} L/h`);
                machineCard.find("strong:contains('Tempo stimato:')").parent().text(`Tempo stimato: ${Math.round(data.quantita / data.portata * 60)} min`);
            }
            
            // Simula progresso
            const progressBar = machineCard.find(".progress-bar");
            progressBar.css("width", "10%").text("10%");
            
            // Simulazione progresso
            const progressInterval = setInterval(function() {
                const currentWidth = parseInt(progressBar.css("width"));
                const containerWidth = progressBar.parent().width();
                const currentPercent = Math.round((currentWidth / containerWidth) * 100);
                
                if (currentPercent < 100) {
                    const newPercent = currentPercent + 5;
                    progressBar.css("width", newPercent + "%").text(newPercent + "%");
                    
                    // Aggiorna tempo rimanente
                    const remainingMinutes = Math.round((100 - newPercent) * 1.2);
                    machineCard.find("small:contains('Tempo rimanente')").text(`Tempo rimanente: ${remainingMinutes} min`);
                } else {
                    clearInterval(progressInterval);
                    machineCard.find(".badge").removeClass("bg-success").addClass("bg-primary").text("Completato");
                    machineCard.find("small:contains('Tempo rimanente')").text("Processo completato");
                }
            }, 3000);
        }

        // Funzioni per aprire modali
        function startProcess(machine, type// Funzioni per aprire modali
        function startProcess(machine, type) {
            // Reset forms
            document.getElementById(`${type}-form`).reset();
            
            // Nascondi tutti i container di "altro"
            $(`#${type}-altro-agrume-container`).hide();
            $(`#${type}-altra-certificazione-container`).hide();
            $(`#${type}-altra-linea-container`).hide();
            $(`#${type}-altra-polpa-container`).hide();
            
            // Preseleziona la macchina
            $(`#${type}-macchina`).val(machine);
            
            // Apri il modal corrispondente
            $(`#${type}Modal`).modal('show');
        }
        
        function viewMachineDetails(machine, type) {
            // Controlla lo stato attuale della macchina
            const machineCard = $(`.machine-card:has(.machine-header:contains('${machine.replace(/\d+$/, ' $&')}'))`);
            const status = machineCard.find('.badge').text();
            
            if (status === 'In attesa') {
                alert('Nessun processo attivo su questa macchina');
                return;
            }
            
            // Raccogli dati attuali
            const product = machineCard.find("strong:contains('Prodotto:')").parent().text().replace('Prodotto: ', '');
            const tipoAgrume = machineCard.find("strong:contains('Tipo Agrume:')").parent().text().replace('Tipo Agrume: ', '');
            const certificazione = machineCard.find("strong:contains('Certificazione:')").parent().text().replace('Certificazione: ', '');
            const progress = machineCard.find(".progress-bar").text().replace('%', '');
            
            // Crea un report di dettaglio
            let details = `Dettagli processo ${type.charAt(0).toUpperCase() + type.slice(1)} - ${machine}\n\n`;
            details += `Stato: ${status}\n`;
            details += `Prodotto: ${product}\n`;
            details += `Tipo Agrume: ${tipoAgrume}\n`;
            details += `Certificazione: ${certificazione}\n`;
            
            if (machineCard.find("strong:contains('Tenore di Polpa:')").length) {
                const tenorePolpa = machineCard.find("strong:contains('Tenore di Polpa:')").parent().text().replace('Tenore di Polpa: ', '');
                details += `Tenore di Polpa: ${tenorePolpa}\n`;
            }
            
            const linea = machineCard.find("strong:contains('Linea:')").parent().text().replace('Linea: ', '');
            details += `Linea: ${linea}\n`;
            
            // Dettagli specifici per tipo di macchina
            if (type === 'concentratore') {
                const brixIniziale = machineCard.find("strong:contains('Brix iniziale:')").parent().text().replace('Brix iniziale: ', '');
                const brixTarget = machineCard.find("strong:contains('Brix target:')").parent().text().replace('Brix target: ', '');
                details += `Brix iniziale: ${brixIniziale}\n`;
                details += `Brix target: ${brixTarget}\n`;
            } else if (type === 'pastorizzatore') {
                const temperatura = machineCard.find("strong:contains('Temperatura:')").parent().text().replace('Temperatura: ', '');
                const portata = machineCard.find("strong:contains('Portata:')").parent().text().replace('Portata: ', '');
                details += `Temperatura: ${temperatura}\n`;
                details += `Portata: ${portata}\n`;
            }
            
            details += `\nProgresso: ${progress}%`;
            
            alert(details);
        }
    </script>
</body>
</html>
